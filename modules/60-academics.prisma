
model Department {
  id          String   @id @default(uuid())
  instituteId String
  name        String
  code        String?
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  institute Institute @relation(fields: [instituteId], references: [id])
  programs  Program[]
  courses   Course[]

  @@unique([instituteId, name])
  @@index([instituteId])
}

model Program {
  id             String   @id @default(uuid())
  instituteId    String
  departmentId   String?
  name           String
  code           String?
  durationMonths Int?
  description    String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  institute  Institute   @relation(fields: [instituteId], references: [id])
  department Department? @relation(fields: [departmentId], references: [id])
  courses    Course[]
  cohorts    Cohort[]

  @@unique([instituteId, name])
  @@index([instituteId])
}

model Course {
  id           String   @id @default(uuid())
  instituteId  String
  programId    String?
  departmentId String?
  code         String
  title        String
  description  String?
  creditHours  Int?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  institute   Institute    @relation(fields: [instituteId], references: [id])
  program     Program?     @relation(fields: [programId], references: [id])
  department  Department?  @relation(fields: [departmentId], references: [id])
  subjects    Subject[]
  assignments Assignment[]
  exams       Exam[]

  @@unique([instituteId, code])
  @@index([instituteId])
}

model Subject {
  id          String   @id @default(uuid())
  courseId    String
  title       String
  code        String?
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  course  Course   @relation(fields: [courseId], references: [id])
  lessons Lesson[]
}

model Lesson {
  id        String   @id @default(uuid())
  subjectId String
  title     String
  content   String?
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  subject Subject @relation(fields: [subjectId], references: [id])
}
