model Fee {
  id          String    @id @default(uuid())
  instituteId String
  title       String
  amount      Float
  type        FeeType
  dueDate     DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now())

  institute Institute @relation(fields: [instituteId], references: [id])
  invoices  Invoice[]

  @@index([instituteId])
}

model Invoice {
  id           String        @id @default(uuid())
  feeId        String
  enrollmentId String?
  invoiceNo    String        @unique
  amount       Float
  status       PaymentStatus @default(PENDING)
  issuedAt     DateTime      @default(now())
  paidAt       DateTime?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @default(now())

  fee        Fee         @relation(fields: [feeId], references: [id])
  enrollment Enrollment? @relation(fields: [enrollmentId], references: [id])
  Payment    Payment[]

  @@index([enrollmentId])
}

model Payment {
  id          String        @id @default(uuid())
  invoiceId   String
  provider    String
  providerRef String?
  amount      Float
  status      PaymentStatus @default(PENDING)
  paidAt      DateTime?
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @default(now())

  invoice Invoice @relation(fields: [invoiceId], references: [id])

  @@index([invoiceId])
}
